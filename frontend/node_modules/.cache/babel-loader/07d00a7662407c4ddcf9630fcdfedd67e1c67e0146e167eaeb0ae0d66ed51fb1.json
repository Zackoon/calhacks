{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lygc7\\\\OneDrive\\\\Desktop\\\\Projects\\\\dittycal\\\\frontend\\\\src\\\\components\\\\Home.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport \"./Home.css\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { motion, useMotionValue, useSpring, useTransform, useAnimation, AnimatePresence } from \"framer-motion\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet oldAudio = null;\nlet mostRecentDir = \"/data-start/2022\";\nconst getNextItems = direction => fetch(mostRecentDir).then(response => response.json()).then(json => json.Songs.map(song => {\n  // Caching hack\n  const img = document.createElement(\"img\");\n  img.src = song.Image;\n  // console.log(img.src)\n  return {\n    id: song.Image,\n    src: song.Image,\n    label: song.Name,\n    audio: song.Audio,\n    artist: song.Artist,\n    uri: song.Uri\n  };\n}));\nconst Card = _ref => {\n  _s();\n  let {\n    src,\n    isActive,\n    onRemove,\n    backgroundTransformer,\n    label,\n    audio,\n    artist,\n    uri,\n    handleRight\n  } = _ref;\n  const cardRef = useRef();\n  const controls = useAnimation();\n  const x = useMotionValue(0);\n  const rotate = useTransform(x, [-100, 0, 100], [-5, 0, 5]);\n  const THRESHOLD = 69;\n  if (oldAudio != null) {\n    oldAudio.pause();\n  }\n  ;\n  let currAudio = new Audio(audio);\n  currAudio.volume = 0.5;\n  currAudio.play();\n  oldAudio = currAudio;\n  if (isActive) {\n    controls.start({\n      scale: 1\n    });\n  }\n  useEffect(() => x.onChange(currentValue => {\n    if (Math.abs(currentValue) <= THRESHOLD) {\n      backgroundTransformer.set(currentValue);\n    }\n  }), [x, backgroundTransformer]);\n  const handleDragEnd = () => {\n    if (x.get() > 0) {\n      mostRecentDir = \"/data-right/\" + uri;\n      handleRight();\n    } else {\n      mostRecentDir = \"/data-left/\" + uri;\n    }\n    if (Math.abs(x.get()) > THRESHOLD) {\n      backgroundTransformer.set(0);\n      onRemove();\n    } else {\n      controls.start({\n        x: 0,\n        y: 0\n      });\n    }\n    console.log(mostRecentDir);\n  };\n  const backgroundImage = `url(${src})`;\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    ref: cardRef,\n    className: \"item\",\n    style: {\n      x,\n      rotate,\n      backgroundImage\n    },\n    drag: true\n    //   dragConstraints={{ left: 0, right: 0, top: 0, bottom: 0 }}\n    ,\n    onDragEnd: handleDragEnd,\n    initial: {\n      scale: 0.9\n    },\n    animate: controls\n    //animate={isActive ? { scale: 1 } : {}}\n    ,\n    custom: x,\n    exit: x => ({\n      x: x.get() * 10\n    }),\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      class: \"itemTitle\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [label, \" - By \", artist]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 5\n  }, this);\n};\n_s(Card, \"f5JZtD/21a9FP4M8q0nPN/qf61o=\", false, function () {\n  return [useAnimation, useMotionValue, useTransform];\n});\n_c = Card;\nexport default function Home(props) {\n  _s2();\n  const backgroundTransformer = useSpring(0, {\n    damping: 10000,\n    mass: 0.01\n  });\n  const background = useTransform(backgroundTransformer, [-50, 0, 50], [\"linear-gradient(90deg, rgba(255,145,145,1) 0%, rgba(255,145,145,0) 50%, rgba(15,15,15,0) 100%)\", \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(15,15,15,0) 50%, rgba(15,15,15,0) 100%)\", \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(126,255,99,0) 50%, rgba(126,255,99,1) 100%)\"]);\n  const [loading, setLoading] = useState(true);\n  const [items, setItems] = useState([]);\n  useEffect(() => {\n    if (items.length < 1) {\n      getNextItems(mostRecentDir).then(newItems => {\n        setItems([...items, ...newItems]);\n        if (loading) setLoading(false);\n      }).catch(err => console.error(err));\n    }\n  });\n  const handleRemoveItem = () => {\n    setItems(items.slice(1));\n  };\n  const displayItems = items.slice(0, 1);\n  const activeItem = displayItems[0];\n  displayItems.reverse(); // the first item should be rendered the last\n  return /*#__PURE__*/_jsxDEV(motion.div, {\n    className: \"App\",\n    style: {\n      background\n    },\n    children: [loading && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 19\n    }, this), !loading && /*#__PURE__*/_jsxDEV(AnimatePresence, {\n      children: displayItems.map(item => /*#__PURE__*/_jsxDEV(Card, {\n        src: item.src,\n        isActive: item === activeItem,\n        onRemove: handleRemoveItem,\n        backgroundTransformer: backgroundTransformer,\n        label: item.label,\n        audio: item.audio,\n        artist: item.artist,\n        uri: item.uri,\n        handleRight: sendIt\n      }, item.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 5\n  }, this);\n}\n_s2(Home, \"bXmmwIbm/gd0EeGaaN/R27GqHNk=\", false, function () {\n  return [useSpring, useTransform];\n});\n_c2 = Home;\nvar _c, _c2;\n$RefreshReg$(_c, \"Card\");\n$RefreshReg$(_c2, \"Home\");","map":{"version":3,"names":["React","useState","useEffect","useRef","motion","useMotionValue","useSpring","useTransform","useAnimation","AnimatePresence","oldAudio","mostRecentDir","getNextItems","direction","fetch","then","response","json","Songs","map","song","img","document","createElement","src","Image","id","label","Name","audio","Audio","artist","Artist","uri","Uri","Card","isActive","onRemove","backgroundTransformer","handleRight","cardRef","controls","x","rotate","THRESHOLD","pause","currAudio","volume","play","start","scale","onChange","currentValue","Math","abs","set","handleDragEnd","get","y","console","log","backgroundImage","Home","props","damping","mass","background","loading","setLoading","items","setItems","length","newItems","catch","err","error","handleRemoveItem","slice","displayItems","activeItem","reverse","item","sendIt"],"sources":["C:/Users/lygc7/OneDrive/Desktop/Projects/dittycal/frontend/src/components/Home.js"],"sourcesContent":["import \"./Home.css\"; \r\nimport React, { useState, useEffect, useRef} from \"react\";\r\nimport {\r\n  motion,\r\n  useMotionValue,\r\n  useSpring,\r\n  useTransform,\r\n  useAnimation,\r\n  AnimatePresence\r\n} from \"framer-motion\";\r\n\r\nlet oldAudio = null;\r\nlet mostRecentDir = \"/data-start/2022\";\r\n\r\nconst getNextItems = (direction) =>\r\n  fetch(mostRecentDir)\r\n    .then(response => response.json())\r\n    .then(json => \r\n      json.Songs.map(song => {\r\n        // Caching hack\r\n        const img = document.createElement(\"img\");\r\n        img.src = song.Image;\r\n        // console.log(img.src)\r\n        return {\r\n          id: song.Image,\r\n          src: song.Image,\r\n          label: song.Name,\r\n          audio: song.Audio,\r\n          artist: song.Artist,\r\n          uri: song.Uri,\r\n        };\r\n      })\r\n    )\r\n\r\n\r\n\r\nconst Card = ({ src, isActive, onRemove, backgroundTransformer, label, audio, artist, uri, handleRight}) => {\r\n  const cardRef = useRef();\r\n\r\n  const controls = useAnimation();\r\n\r\n  const x = useMotionValue(0);\r\n  const rotate = useTransform(x, [-100, 0, 100], [-5, 0, 5]);\r\n\r\n  const THRESHOLD = 69;\r\n\r\n  if (oldAudio != null){oldAudio.pause()};\r\n  let currAudio = new Audio(audio)\r\n  currAudio.volume = 0.5;\r\n  currAudio.play()\r\n  oldAudio = currAudio;\r\n\r\n  if (isActive) {\r\n    controls.start({ scale: 1 });\r\n  }\r\n\r\n  useEffect(\r\n    () =>\r\n      x.onChange(currentValue => {\r\n        if (Math.abs(currentValue) <= THRESHOLD) {\r\n          backgroundTransformer.set(currentValue);\r\n        }\r\n      }),\r\n    [x, backgroundTransformer]\r\n  );\r\n\r\n  const handleDragEnd = () => {\r\n    if (x.get()>0){\r\n        mostRecentDir = \"/data-right/\"+uri\r\n        handleRight()\r\n    } else {\r\n        mostRecentDir = \"/data-left/\"+uri\r\n    }\r\n    if (Math.abs(x.get()) > THRESHOLD) {\r\n      backgroundTransformer.set(0);\r\n      onRemove();\r\n    } else {\r\n      controls.start({ x: 0, y: 0 });\r\n    }\r\n    console.log(mostRecentDir);\r\n  };\r\n\r\n  const backgroundImage = `url(${src})`;\r\n\r\n  return (\r\n    <motion.div\r\n      ref={cardRef}\r\n      className=\"item\"\r\n      style={{ x, rotate, backgroundImage }}\r\n      drag={true}\r\n    //   dragConstraints={{ left: 0, right: 0, top: 0, bottom: 0 }}\r\n      onDragEnd={handleDragEnd}\r\n      initial={{ scale: 0.9 }}\r\n      animate={controls}\r\n      //animate={isActive ? { scale: 1 } : {}}\r\n      custom={x}\r\n      exit={x => ({ x: x.get() * 10 })}\r\n    >\r\n      <div class = \"itemTitle\"> \r\n        <p>{label} - By {artist}</p>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default function Home(props) {\r\n  const backgroundTransformer = useSpring(0, {\r\n    damping: 10000,\r\n    mass: 0.01\r\n  });\r\n  const background = useTransform(\r\n    backgroundTransformer,\r\n    [-50, 0, 50],\r\n    [\r\n      \"linear-gradient(90deg, rgba(255,145,145,1) 0%, rgba(255,145,145,0) 50%, rgba(15,15,15,0) 100%)\",\r\n      \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(15,15,15,0) 50%, rgba(15,15,15,0) 100%)\",\r\n      \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(126,255,99,0) 50%, rgba(126,255,99,1) 100%)\"\r\n    ]\r\n  );\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [items, setItems] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (items.length < 1) {\r\n        getNextItems(mostRecentDir)\r\n        .then(newItems => {\r\n          setItems([...items, ...newItems]);\r\n          if (loading) setLoading(false);\r\n        })\r\n        .catch(err => console.error(err));\r\n    }\r\n  });\r\n\r\n  const handleRemoveItem = () => {\r\n    setItems(items.slice(1));\r\n  };\r\n\r\n  const displayItems = items.slice(0, 1);\r\n  const activeItem = displayItems[0];\r\n\r\n  displayItems.reverse(); // the first item should be rendered the last\r\n  return (\r\n    <motion.div className=\"App\" style={{ background }}>\r\n      {loading && <div>Loading...</div>}\r\n      {!loading && (\r\n        <AnimatePresence>\r\n          {displayItems.map(item => (\r\n            <Card\r\n              key={item.id}\r\n              src={item.src}\r\n              isActive={item === activeItem}\r\n              onRemove={handleRemoveItem}\r\n              backgroundTransformer={backgroundTransformer}\r\n              label = {item.label}\r\n              audio = {item.audio}\r\n              artist = {item.artist}\r\n              uri = {item.uri}\r\n              handleRight = {sendIt}\r\n            />\r\n          ))}\r\n        </AnimatePresence>\r\n      )}\r\n    </motion.div>\r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}