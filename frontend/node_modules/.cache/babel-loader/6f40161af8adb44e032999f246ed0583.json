{"ast":null,"code":"import _toConsumableArray from\"/Users/nikhil/Desktop/CalHacks/dittyCal/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/nikhil/Desktop/CalHacks/dittyCal/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./Home.css\";import React,{useState,useEffect,useRef}from\"react\";import{motion,useMotionValue,useSpring,useTransform,useAnimation,AnimatePresence}from\"framer-motion\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var oldAudio=null;var mostRecentDir=\"/data-start/2022\";var getNextItems=function getNextItems(direction){return fetch(mostRecentDir).then(function(response){return response.json();}).then(function(json){return json.Songs.map(function(song){// Caching hack\nvar img=document.createElement(\"img\");img.src=song.Image;// console.log(img.src)\nreturn{id:song.Image,src:song.Image,label:song.Name,audio:song.Audio,artist:song.Artist,uri:song.Uri};});});};var Card=function Card(_ref){var src=_ref.src,isActive=_ref.isActive,onRemove=_ref.onRemove,backgroundTransformer=_ref.backgroundTransformer,label=_ref.label,audio=_ref.audio,artist=_ref.artist,uri=_ref.uri;var cardRef=useRef();var controls=useAnimation();var x=useMotionValue(0);var rotate=useTransform(x,[-100,0,100],[-5,0,5]);var THRESHOLD=69;if(oldAudio!=null){oldAudio.pause();};var currAudio=new Audio(audio);currAudio.play();oldAudio=currAudio;if(isActive){controls.start({scale:1});}useEffect(function(){return x.onChange(function(currentValue){if(Math.abs(currentValue)<=THRESHOLD){backgroundTransformer.set(currentValue);}});},[x,backgroundTransformer]);var handleDragEnd=function handleDragEnd(){if(x.get()>0){mostRecentDir=\"/data-right/\"+uri;}else{mostRecentDir=\"/data-left/\"+uri;}if(Math.abs(x.get())>THRESHOLD){backgroundTransformer.set(0);onRemove();}else{controls.start({x:0,y:0});}console.log(mostRecentDir);};var backgroundImage=\"url(\".concat(src,\")\");return/*#__PURE__*/_jsx(motion.div,{ref:cardRef,className:\"item\",style:{x:x,rotate:rotate,backgroundImage:backgroundImage},drag:true//   dragConstraints={{ left: 0, right: 0, top: 0, bottom: 0 }}\n,onDragEnd:handleDragEnd,initial:{scale:0.9},animate:controls//animate={isActive ? { scale: 1 } : {}}\n,custom:x,exit:function exit(x){return{x:x.get()*10};},children:/*#__PURE__*/_jsx(\"div\",{class:\"itemTitle\",children:/*#__PURE__*/_jsxs(\"p\",{children:[label,\" - By \",artist]})})});};export default function Home(){var backgroundTransformer=useSpring(0,{damping:10000,mass:0.01});var background=useTransform(backgroundTransformer,[-50,0,50],[\"linear-gradient(90deg, rgba(255,145,145,1) 0%, rgba(255,145,145,0) 50%, rgba(15,15,15,0) 100%)\",\"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(15,15,15,0) 50%, rgba(15,15,15,0) 100%)\",\"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(126,255,99,0) 50%, rgba(126,255,99,1) 100%)\"]);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),items=_useState4[0],setItems=_useState4[1];useEffect(function(){if(items.length<1){getNextItems(mostRecentDir).then(function(newItems){setItems([].concat(_toConsumableArray(items),_toConsumableArray(newItems)));if(loading)setLoading(false);}).catch(function(err){return console.error(err);});}});var handleRemoveItem=function handleRemoveItem(){setItems(items.slice(1));};var displayItems=items.slice(0,1);var activeItem=displayItems[0];displayItems.reverse();// the first item should be rendered the last\nreturn/*#__PURE__*/_jsxs(motion.div,{className:\"App\",style:{background:background},children:[loading&&/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),!loading&&/*#__PURE__*/_jsx(AnimatePresence,{children:displayItems.map(function(item){return/*#__PURE__*/_jsx(Card,{src:item.src,isActive:item===activeItem,onRemove:handleRemoveItem,backgroundTransformer:backgroundTransformer,label:item.label,audio:item.audio,artist:item.artist,uri:item.uri},item.id);})})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","motion","useMotionValue","useSpring","useTransform","useAnimation","AnimatePresence","oldAudio","mostRecentDir","getNextItems","direction","fetch","then","response","json","Songs","map","song","img","document","createElement","src","Image","id","label","Name","audio","Audio","artist","Artist","uri","Uri","Card","isActive","onRemove","backgroundTransformer","cardRef","controls","x","rotate","THRESHOLD","pause","currAudio","play","start","scale","onChange","currentValue","Math","abs","set","handleDragEnd","get","y","console","log","backgroundImage","Home","damping","mass","background","loading","setLoading","items","setItems","length","newItems","catch","err","error","handleRemoveItem","slice","displayItems","activeItem","reverse","item"],"sources":["/Users/nikhil/Desktop/CalHacks/dittyCal/frontend/src/components/Home.js"],"sourcesContent":["import \"./Home.css\"; \nimport React, { useState, useEffect, useRef} from \"react\";\nimport {\n  motion,\n  useMotionValue,\n  useSpring,\n  useTransform,\n  useAnimation,\n  AnimatePresence\n} from \"framer-motion\";\n\nlet oldAudio = null;\nlet mostRecentDir = \"/data-start/2022\";\n\nconst getNextItems = (direction) =>\n  fetch(mostRecentDir)\n    .then(response => response.json())\n    .then(json => \n      json.Songs.map(song => {\n        // Caching hack\n        const img = document.createElement(\"img\");\n        img.src = song.Image;\n        // console.log(img.src)\n        return {\n          id: song.Image,\n          src: song.Image,\n          label: song.Name,\n          audio: song.Audio,\n          artist: song.Artist,\n          uri: song.Uri,\n        };\n      })\n    )\n\n\n\nconst Card = ({ src, isActive, onRemove, backgroundTransformer, label, audio, artist, uri }) => {\n  const cardRef = useRef();\n\n  const controls = useAnimation();\n\n  const x = useMotionValue(0);\n  const rotate = useTransform(x, [-100, 0, 100], [-5, 0, 5]);\n\n  const THRESHOLD = 69;\n\n  if (oldAudio != null){oldAudio.pause()};\n  let currAudio = new Audio(audio)\n  currAudio.play()\n  oldAudio = currAudio;\n\n  if (isActive) {\n    controls.start({ scale: 1 });\n  }\n\n  useEffect(\n    () =>\n      x.onChange(currentValue => {\n        if (Math.abs(currentValue) <= THRESHOLD) {\n          backgroundTransformer.set(currentValue);\n        }\n      }),\n    [x, backgroundTransformer]\n  );\n\n  const handleDragEnd = () => {\n    if (x.get()>0){\n        mostRecentDir = \"/data-right/\"+uri\n    } else {\n        mostRecentDir = \"/data-left/\"+uri\n    }\n    if (Math.abs(x.get()) > THRESHOLD) {\n      backgroundTransformer.set(0);\n      onRemove();\n    } else {\n      controls.start({ x: 0, y: 0 });\n    }\n    console.log(mostRecentDir);\n  };\n\n  const backgroundImage = `url(${src})`;\n\n  return (\n    <motion.div\n      ref={cardRef}\n      className=\"item\"\n      style={{ x, rotate, backgroundImage }}\n      drag={true}\n    //   dragConstraints={{ left: 0, right: 0, top: 0, bottom: 0 }}\n      onDragEnd={handleDragEnd}\n      initial={{ scale: 0.9 }}\n      animate={controls}\n      //animate={isActive ? { scale: 1 } : {}}\n      custom={x}\n      exit={x => ({ x: x.get() * 10 })}\n    >\n      <div class = \"itemTitle\"> \n        <p>{label} - By {artist}</p>\n      </div>\n    </motion.div>\n  );\n};\n\nexport default function Home() {\n  const backgroundTransformer = useSpring(0, {\n    damping: 10000,\n    mass: 0.01\n  });\n  const background = useTransform(\n    backgroundTransformer,\n    [-50, 0, 50],\n    [\n      \"linear-gradient(90deg, rgba(255,145,145,1) 0%, rgba(255,145,145,0) 50%, rgba(15,15,15,0) 100%)\",\n      \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(15,15,15,0) 50%, rgba(15,15,15,0) 100%)\",\n      \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(126,255,99,0) 50%, rgba(126,255,99,1) 100%)\"\n    ]\n  );\n\n  const [loading, setLoading] = useState(true);\n  const [items, setItems] = useState([]);\n\n  useEffect(() => {\n    if (items.length < 1) {\n        getNextItems(mostRecentDir)\n        .then(newItems => {\n          setItems([...items, ...newItems]);\n          if (loading) setLoading(false);\n        })\n        .catch(err => console.error(err));\n    }\n  });\n\n  const handleRemoveItem = () => {\n    setItems(items.slice(1));\n  };\n\n  const displayItems = items.slice(0, 1);\n  const activeItem = displayItems[0];\n\n  displayItems.reverse(); // the first item should be rendered the last\n  return (\n    <motion.div className=\"App\" style={{ background }}>\n      {loading && <div>Loading...</div>}\n      {!loading && (\n        <AnimatePresence>\n          {displayItems.map(item => (\n            <Card\n              key={item.id}\n              src={item.src}\n              isActive={item === activeItem}\n              onRemove={handleRemoveItem}\n              backgroundTransformer={backgroundTransformer}\n              label = {item.label}\n              audio = {item.audio}\n              artist = {item.artist}\n              uri = {item.uri}\n            />\n          ))}\n        </AnimatePresence>\n      )}\n    </motion.div>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}