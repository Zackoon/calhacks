{"ast":null,"code":"import _toConsumableArray from\"C:/Users/lygc7/OneDrive/Desktop/Projects/dittycal/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/lygc7/OneDrive/Desktop/Projects/dittycal/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import\"./Home.css\";import React,{useState,useEffect,useRef}from\"react\";import{motion,useMotionValue,useSpring,useTransform,useAnimation,AnimatePresence}from\"framer-motion\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var oldAudio=null;var mostRecentDir=\"/data-start/2022\";var getNextItems=function getNextItems(direction){return fetch(mostRecentDir).then(function(response){return response.json();}).then(function(json){return json.Songs.map(function(song){// Caching hack\nvar img=document.createElement(\"img\");img.src=song.Image;// console.log(img.src)\nreturn{id:song.Image,src:song.Image,label:song.Name,audio:song.Audio,artist:song.Artist,uri:song.Uri};});});};var Card=function Card(_ref){var src=_ref.src,isActive=_ref.isActive,onRemove=_ref.onRemove,backgroundTransformer=_ref.backgroundTransformer,label=_ref.label,audio=_ref.audio,artist=_ref.artist,uri=_ref.uri,handleRight=_ref.handleRight;var cardRef=useRef();var controls=useAnimation();var x=useMotionValue(0);var rotate=useTransform(x,[-100,0,100],[-5,0,5]);var THRESHOLD=69;if(oldAudio!=null){oldAudio.pause();};var currAudio=new Audio(audio);currAudio.volume=0.5;currAudio.play();oldAudio=currAudio;if(isActive){controls.start({scale:1});}useEffect(function(){return x.onChange(function(currentValue){if(Math.abs(currentValue)<=THRESHOLD){backgroundTransformer.set(currentValue);}});},[x,backgroundTransformer]);var handleDragEnd=function handleDragEnd(){if(x.get()>0){mostRecentDir=\"/data-right/\"+uri;handleRight(uri);}else{mostRecentDir=\"/data-left/\"+uri;}if(Math.abs(x.get())>THRESHOLD){backgroundTransformer.set(0);onRemove();}else{controls.start({x:0,y:0});}console.log(mostRecentDir);};var backgroundImage=\"url(\".concat(src,\")\");return/*#__PURE__*/_jsx(motion.div,{ref:cardRef,className:\"item\",style:{x:x,rotate:rotate,backgroundImage:backgroundImage},drag:true//   dragConstraints={{ left: 0, right: 0, top: 0, bottom: 0 }}\n,onDragEnd:handleDragEnd,initial:{scale:0.9},animate:controls//animate={isActive ? { scale: 1 } : {}}\n,custom:x,exit:function exit(x){return{x:x.get()*10};},children:/*#__PURE__*/_jsx(\"div\",{class:\"itemTitle\",children:/*#__PURE__*/_jsxs(\"p\",{children:[label,\" - By \",artist]})})});};export default function Home(props){var backgroundTransformer=useSpring(0,{damping:10000,mass:0.01});var background=useTransform(backgroundTransformer,[-50,0,50],[\"linear-gradient(90deg, rgba(255,145,145,1) 0%, rgba(255,145,145,0) 50%, rgba(15,15,15,0) 100%)\",\"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(15,15,15,0) 50%, rgba(15,15,15,0) 100%)\",\"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(126,255,99,0) 50%, rgba(126,255,99,1) 100%)\"]);var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),items=_useState4[0],setItems=_useState4[1];useEffect(function(){if(items.length<1){getNextItems(mostRecentDir).then(function(newItems){setItems([].concat(_toConsumableArray(items),_toConsumableArray(newItems)));if(loading)setLoading(false);}).catch(function(err){return console.error(err);});}});var handleRemoveItem=function handleRemoveItem(){setItems(items.slice(1));};var sendIt=function sendIt(uri){props.handleLike(uri);};var displayItems=items.slice(0,1);var activeItem=displayItems[0];displayItems.reverse();// the first item should be rendered the last\nreturn/*#__PURE__*/_jsxs(motion.div,{className:\"App\",style:{background:background},children:[loading&&/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),!loading&&/*#__PURE__*/_jsx(AnimatePresence,{children:displayItems.map(function(item){return/*#__PURE__*/_jsx(Card,{src:item.src,isActive:item===activeItem,onRemove:handleRemoveItem,backgroundTransformer:backgroundTransformer,label:item.label,audio:item.audio,artist:item.artist,uri:item.uri,handleRight:sendIt},item.id);})})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","motion","useMotionValue","useSpring","useTransform","useAnimation","AnimatePresence","oldAudio","mostRecentDir","getNextItems","direction","fetch","then","response","json","Songs","map","song","img","document","createElement","src","Image","id","label","Name","audio","Audio","artist","Artist","uri","Uri","Card","isActive","onRemove","backgroundTransformer","handleRight","cardRef","controls","x","rotate","THRESHOLD","pause","currAudio","volume","play","start","scale","onChange","currentValue","Math","abs","set","handleDragEnd","get","y","console","log","backgroundImage","Home","props","damping","mass","background","loading","setLoading","items","setItems","length","newItems","catch","err","error","handleRemoveItem","slice","sendIt","handleLike","displayItems","activeItem","reverse","item"],"sources":["C:/Users/lygc7/OneDrive/Desktop/Projects/dittycal/frontend/src/components/Home.js"],"sourcesContent":["import \"./Home.css\"; \r\nimport React, { useState, useEffect, useRef} from \"react\";\r\nimport {\r\n  motion,\r\n  useMotionValue,\r\n  useSpring,\r\n  useTransform,\r\n  useAnimation,\r\n  AnimatePresence\r\n} from \"framer-motion\";\r\n\r\nlet oldAudio = null;\r\nlet mostRecentDir = \"/data-start/2022\";\r\n\r\nconst getNextItems = (direction) =>\r\n  fetch(mostRecentDir)\r\n    .then(response => response.json())\r\n    .then(json => \r\n      json.Songs.map(song => {\r\n        // Caching hack\r\n        const img = document.createElement(\"img\");\r\n        img.src = song.Image;\r\n        // console.log(img.src)\r\n        return {\r\n          id: song.Image,\r\n          src: song.Image,\r\n          label: song.Name,\r\n          audio: song.Audio,\r\n          artist: song.Artist,\r\n          uri: song.Uri,\r\n        };\r\n      })\r\n    )\r\n\r\n\r\n\r\nconst Card = ({ src, isActive, onRemove, backgroundTransformer, label, audio, artist, uri, handleRight}) => {\r\n  const cardRef = useRef();\r\n\r\n  const controls = useAnimation();\r\n\r\n  const x = useMotionValue(0);\r\n  const rotate = useTransform(x, [-100, 0, 100], [-5, 0, 5]);\r\n\r\n  const THRESHOLD = 69;\r\n\r\n  if (oldAudio != null){oldAudio.pause()};\r\n  let currAudio = new Audio(audio)\r\n  currAudio.volume = 0.5;\r\n  currAudio.play()\r\n  oldAudio = currAudio;\r\n\r\n  if (isActive) {\r\n    controls.start({ scale: 1 });\r\n  }\r\n\r\n  useEffect(\r\n    () =>\r\n      x.onChange(currentValue => {\r\n        if (Math.abs(currentValue) <= THRESHOLD) {\r\n          backgroundTransformer.set(currentValue);\r\n        }\r\n      }),\r\n    [x, backgroundTransformer]\r\n  );\r\n\r\n  const handleDragEnd = () => {\r\n    if (x.get()>0){\r\n        mostRecentDir = \"/data-right/\"+uri\r\n        handleRight(uri);\r\n    } else {\r\n        mostRecentDir = \"/data-left/\"+uri\r\n    }\r\n    if (Math.abs(x.get()) > THRESHOLD) {\r\n      backgroundTransformer.set(0);\r\n      onRemove();\r\n    } else {\r\n      controls.start({ x: 0, y: 0 });\r\n    }\r\n    console.log(mostRecentDir);\r\n  };\r\n\r\n  const backgroundImage = `url(${src})`;\r\n\r\n  return (\r\n    <motion.div\r\n      ref={cardRef}\r\n      className=\"item\"\r\n      style={{ x, rotate, backgroundImage }}\r\n      drag={true}\r\n    //   dragConstraints={{ left: 0, right: 0, top: 0, bottom: 0 }}\r\n      onDragEnd={handleDragEnd}\r\n      initial={{ scale: 0.9 }}\r\n      animate={controls}\r\n      //animate={isActive ? { scale: 1 } : {}}\r\n      custom={x}\r\n      exit={x => ({ x: x.get() * 10 })}\r\n    >\r\n      <div class = \"itemTitle\"> \r\n        <p>{label} - By {artist}</p>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n};\r\n\r\nexport default function Home(props) {\r\n  const backgroundTransformer = useSpring(0, {\r\n    damping: 10000,\r\n    mass: 0.01\r\n  });\r\n  const background = useTransform(\r\n    backgroundTransformer,\r\n    [-50, 0, 50],\r\n    [\r\n      \"linear-gradient(90deg, rgba(255,145,145,1) 0%, rgba(255,145,145,0) 50%, rgba(15,15,15,0) 100%)\",\r\n      \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(15,15,15,0) 50%, rgba(15,15,15,0) 100%)\",\r\n      \"linear-gradient(90deg, rgba(15,15,15,0) 0%, rgba(126,255,99,0) 50%, rgba(126,255,99,1) 100%)\"\r\n    ]\r\n  );\r\n\r\n  const [loading, setLoading] = useState(true);\r\n  const [items, setItems] = useState([]);\r\n\r\n  useEffect(() => {\r\n    if (items.length < 1) {\r\n        getNextItems(mostRecentDir)\r\n        .then(newItems => {\r\n          setItems([...items, ...newItems]);\r\n          if (loading) setLoading(false);\r\n        })\r\n        .catch(err => console.error(err));\r\n    }\r\n  });\r\n\r\n  const handleRemoveItem = () => {\r\n    setItems(items.slice(1));\r\n  };\r\n  const sendIt = (uri) => {\r\n    props.handleLike(uri);\r\n  }\r\n\r\n  const displayItems = items.slice(0, 1);\r\n  const activeItem = displayItems[0];\r\n\r\n  displayItems.reverse(); // the first item should be rendered the last\r\n  return (\r\n    <motion.div className=\"App\" style={{ background }}>\r\n      {loading && <div>Loading...</div>}\r\n      {!loading && (\r\n        <AnimatePresence>\r\n          {displayItems.map(item => (\r\n            <Card\r\n              key={item.id}\r\n              src={item.src}\r\n              isActive={item === activeItem}\r\n              onRemove={handleRemoveItem}\r\n              backgroundTransformer={backgroundTransformer}\r\n              label = {item.label}\r\n              audio = {item.audio}\r\n              artist = {item.artist}\r\n              uri = {item.uri}\r\n              handleRight = {sendIt}\r\n            />\r\n          ))}\r\n        </AnimatePresence>\r\n      )}\r\n    </motion.div>\r\n  );\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}